import{_ as M}from"./BNBFR6TF.js";import T from"./BWBek36E.js";import{d as B,W as H,X as O,r as d,E as R,o as D,c as o,e as a,f as e,N as u,g as m,t as h,G as U,w as y,k as w,h as k,Y as G,Z as I,$ as V,a0 as P,a1 as S,p as $,j,l as q}from"./Bh_OSRoe.js";import"./Bm4K94d7.js";import"./CwLGbeD0.js";const p=_=>($("data-v-0894f54a"),_=_(),j(),_),z={class:"flex items-center h-36 w-36 z-50"},F=["src"],J={class:"text-base-200 text-lg mb-1"},K={class:"ml-4"},W={key:0,class:"flex flex-col items-center bg-base-200 p-4 rounded-2xl shadow-lg transition-all duration-300 absolute top-36 left-0"},X={key:0,class:"text-center text-info"},Y=p(()=>e("div",null,"Loading, please wait...",-1)),Z={key:1,class:"text-center"},Q={class:"mb-4"},ee={class:"text-lg font-semibold"},te=["autocomplete"],se=p(()=>e("label",{for:"login",class:"block text-sm mb-1"},"Login:",-1)),oe=p(()=>e("label",{for:"password",class:"block text-sm mb-1"},"Password:",-1)),ae={class:"flex items-center justify-between"},re=p(()=>e("label",{for:"stayLoggedIn",class:"text-sm"},"Stay Logged in",-1)),le=p(()=>e("button",{type:"submit",class:"bg-info text-default py-1 px-3 rounded"}," Login ",-1)),ne={class:"text-center mt-2"},ce={key:3,class:"text-warning mt-2"},ie=B({__name:"avatar-banner",setup(_){const s=H(),l=O(),g=d(""),f=d(""),x=d(!1),v=R(()=>s.isLoggedIn),n=d(!0),c=d(null),N=R(()=>v.value?`Hello, ${s.username} ðŸŽ‰`:"Welcome, Kind Guest"),L=()=>{x.value=!x.value},A=async()=>{l.clearError();try{const t=await l.handleError(()=>s.login({username:g.value,password:f.value}),S.AUTH_ERROR,"Failed to login. Please try again.");t.success?n.value&&localStorage.setItem("user",JSON.stringify({username:g.value})):(l.setError(S.AUTH_ERROR,t.message),c.value=t.message)}catch(t){c.value="An error occurred during login.",console.error(t)}},C=async()=>{l.clearError();try{await l.handleError(async()=>s.logout(),S.AUTH_ERROR,"Failed to logout. Please try again."),n.value||localStorage.removeItem("user")}catch(t){c.value="An error occurred during logout.",console.error(t)}};return D(()=>{const t=JSON.parse(localStorage.getItem("user")||"null");t&&t.username!=="Kind Guest"&&s.setUser(t)}),(t,r)=>{const b=M,E=T;return o(),a("div",z,[e("div",{class:"flex flex-col items-start cursor-pointer",onClick:L},[u(s).avatarImage?(o(),a("img",{key:0,src:u(s).avatarImage,class:"w-8 h-8 rounded-full mb-2",alt:"Avatar"},null,8,F)):m("",!0),e("span",J,h(N.value),1),v.value?(o(),U(b,{key:1,to:"/dashboard",class:"text-accent underline text-sm"},{default:y(()=>[w(" Dashboard ")]),_:1})):m("",!0),v.value&&u(s).role==="admin"?(o(),U(b,{key:2,to:"/admin",class:"text-accent underline text-sm mt-1"},{default:y(()=>[w(" Admin ")]),_:1})):m("",!0)]),e("div",K,[k(E,{name:"tabler:user",class:"text-base-200 text-2xl cursor-pointer",onClick:L})]),x.value?(o(),a("div",W,[u(s).loading?(o(),a("div",X,[k(E,{name:"tabler:loader",class:"animate-spin text-lg mb-2"}),Y])):v.value?(o(),a("div",Z,[e("div",Q,[e("span",ee,"Hello, "+h(u(s).username)+" ðŸŽ‰",1)]),e("button",{class:"bg-warning text-default py-1 px-3 rounded",onClick:C}," Logout ")])):(o(),a("form",{key:2,class:"space-y-4 z-50",autocomplete:n.value?"on":"off",onSubmit:G(A,["prevent"])},[e("div",null,[se,I(e("input",{id:"login","onUpdate:modelValue":r[0]||(r[0]=i=>g.value=i),type:"text",autocomplete:"username",class:"w-full p-2 border rounded",required:""},null,512),[[V,g.value]])]),e("div",null,[oe,I(e("input",{id:"password","onUpdate:modelValue":r[1]||(r[1]=i=>f.value=i),type:"password",autocomplete:"current-password",class:"w-full p-2 border rounded",required:""},null,512),[[V,f.value]])]),e("div",ae,[e("div",null,[I(e("input",{id:"stayLoggedIn","onUpdate:modelValue":r[2]||(r[2]=i=>n.value=i),type:"checkbox",class:"mr-2"},null,512),[[P,n.value]]),re]),le]),e("div",ne,[k(b,{to:"/register",class:"text-accent underline"},{default:y(()=>[w(" Register ")]),_:1})])],40,te)),c.value?(o(),a("div",ce,h(c.value),1)):m("",!0)])):m("",!0)])}}}),ge=q(ie,[["__scopeId","data-v-0894f54a"]]);export{ge as default};
