const d={init:Ot,document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function Y(){}function Ot(e){const t=e;d.document=t.document,d.DocumentFragment=t.DocumentFragment||Y,d.SVGElement=t.SVGElement||Y,d.SVGSVGElement=t.SVGSVGElement||Y,d.SVGElementInstance=t.SVGElementInstance||Y,d.Element=t.Element||Y,d.HTMLElement=t.HTMLElement||d.Element,d.Event=t.Event,d.Touch=t.Touch||Y,d.PointerEvent=t.PointerEvent||t.MSPointerEvent}var pt=e=>!!(e&&e.Window)&&e instanceof e.Window;let ft,X;function dt(e){ft=e;const t=e.document.createTextNode("");t.ownerDocument!==e.document&&typeof e.wrap=="function"&&e.wrap(t)===t&&(e=e.wrap(e)),X=e}typeof window<"u"&&window&&dt(window);function C(e){return pt(e)?e:(e.ownerDocument||e).defaultView||X.window}const Rt=e=>e===X||pt(e),Xt=e=>W(e)&&e.nodeType===11,W=e=>!!e&&typeof e=="object",mt=e=>typeof e=="function",$t=e=>typeof e=="number",Yt=e=>typeof e=="boolean",At=e=>typeof e=="string",Ct=e=>{if(!e||typeof e!="object")return!1;const t=C(e)||X;return/object|function/.test(typeof Element)?e instanceof Element||e instanceof t.Element:e.nodeType===1&&typeof e.nodeName=="string"},Ft=e=>W(e)&&!!e.constructor&&/function Object\b/.test(e.constructor.toString()),kt=e=>W(e)&&typeof e.length<"u"&&mt(e.splice);var c={window:Rt,docFrag:Xt,object:W,func:mt,number:$t,bool:Yt,string:At,element:Ct,plainObject:Ft,array:kt};const y={init:Lt,supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null};function Lt(e){const t=d.Element,n=e.navigator||{};y.supportsTouch="ontouchstart"in e||c.func(e.DocumentTouch)&&d.document instanceof e.DocumentTouch,y.supportsPointerEvent=n.pointerEnabled!==!1&&!!d.PointerEvent,y.isIOS=/iP(hone|od|ad)/.test(n.platform),y.isIOS7=/iP(hone|od|ad)/.test(n.platform)&&/OS 7[^\d]/.test(n.appVersion),y.isIe9=/MSIE 9/.test(n.userAgent),y.isOperaMobile=n.appName==="Opera"&&y.supportsTouch&&/Presto/.test(n.userAgent),y.prefixedMatchesSelector="matches"in t.prototype?"matches":"webkitMatchesSelector"in t.prototype?"webkitMatchesSelector":"mozMatchesSelector"in t.prototype?"mozMatchesSelector":"oMatchesSelector"in t.prototype?"oMatchesSelector":"msMatchesSelector",y.pEventTypes=y.supportsPointerEvent?d.PointerEvent===e.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,y.wheelEvent=d.document&&"onmousewheel"in d.document?"mousewheel":"wheel"}const vt=(e,t)=>{for(const n of t)e.push(n);return e},gt=e=>vt([],e),N=(e,t)=>{for(let n=0;n<e.length;n++)if(t(e[n],n,e))return n;return-1},G=(e,t)=>e[N(e,t)];function K(e){const t={};for(const n in e){const i=e[n];c.plainObject(i)?t[n]=K(i):c.array(i)?t[n]=gt(i):t[n]=i}return t}function T(e,t){for(const i in t)e[i]=t[i];return e}let it=0,I,M;function jt(e){if(I=e.requestAnimationFrame,M=e.cancelAnimationFrame,!I){const t=["ms","moz","webkit","o"];for(const n of t)I=e[`${n}RequestAnimationFrame`],M=e[`${n}CancelAnimationFrame`]||e[`${n}CancelRequestAnimationFrame`]}I=I&&I.bind(e),M=M&&M.bind(e),I||(I=t=>{const n=Date.now(),i=Math.max(0,16-(n-it)),s=e.setTimeout(()=>{t(n+i)},i);return it=n+i,s},M=t=>clearTimeout(t))}var Ut={request:e=>I(e),cancel:e=>M(e),init:jt};function A(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s=>!0,i=arguments.length>3?arguments[3]:void 0;if(i=i||{},c.string(e)&&e.search(" ")!==-1&&(e=st(e)),c.array(e))return e.forEach(s=>A(s,t,n,i)),i;if(c.object(e)&&(t=e,e=""),c.func(t)&&n(e))i[e]=i[e]||[],i[e].push(t);else if(c.array(t))for(const s of t)A(e,s,n,i);else if(c.object(t))for(const s in t){const o=st(s).map(r=>`${e}${r}`);A(o,t[s],n,i)}return i}function st(e){return e.trim().split(/ +/)}function ot(e,t){for(const n of t){if(e.immediatePropagationStopped)break;n(e)}}class yt{constructor(t){this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=T({},t||{})}fire(t){let n;const i=this.global;(n=this.types[t.type])&&ot(t,n),!t.propagationStopped&&i&&(n=i[t.type])&&ot(t,n)}on(t,n){const i=A(t,n);for(t in i)this.types[t]=vt(this.types[t]||[],i[t])}off(t,n){const i=A(t,n);for(t in i){const s=this.types[t];if(!(!s||!s.length))for(const o of i[t]){const r=s.indexOf(o);r!==-1&&s.splice(r,1)}}}getRect(t){return null}}function O(e,t){if(e.contains)return e.contains(t);for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function Et(e,t){for(;c.element(e);){if(R(e,t))return e;e=j(e)}return null}function j(e){let t=e.parentNode;if(c.docFrag(t)){for(;(t=t.host)&&c.docFrag(t););return t}return t}function R(e,t){return X!==ft&&(t=t.replace(/\/deep\//g," ")),e[y.prefixedMatchesSelector](t)}function rt(e,t,n){for(;c.element(e);){if(R(e,t))return!0;if(e=j(e),e===n)return R(e,t)}return!1}function ct(e){return e.correspondingUseElement||e}function Gt(e){return e=e||X,{x:e.scrollX||e.document.documentElement.scrollLeft,y:e.scrollY||e.document.documentElement.scrollTop}}function bt(e){const t=e instanceof d.SVGElement?e.getBoundingClientRect():e.getClientRects()[0];return t&&{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width||t.right-t.left,height:t.height||t.bottom-t.top}}function Q(e){const t=bt(e);if(!y.isIOS7&&t){const n=Gt(C(e));t.left+=n.x,t.right+=n.x,t.top+=n.y,t.bottom+=n.y}return t}function at(e){return c.string(e)?(d.document.querySelector(e),!0):!1}const Kt=["webkit","moz"];function xt(e,t){e.__set||(e.__set={});for(const n in t)Kt.some(i=>n.indexOf(i)===0)||typeof e[n]!="function"&&n!=="__set"&&Object.defineProperty(e,n,{get(){return n in e.__set?e.__set[n]:e.__set[n]=t[n]},set(i){e.__set[n]=i},configurable:!0});return e}var tt=(e,t)=>Math.sqrt(e*e+t*t);function V(e,t){e.page=e.page||{},e.page.x=t.page.x,e.page.y=t.page.y,e.client=e.client||{},e.client.x=t.client.x,e.client.y=t.client.y,e.timeStamp=t.timeStamp}function qt(e,t,n){e.page.x=n.page.x-t.page.x,e.page.y=n.page.y-t.page.y,e.client.x=n.client.x-t.client.x,e.client.y=n.client.y-t.client.y,e.timeStamp=n.timeStamp-t.timeStamp}function zt(e,t){const n=Math.max(t.timeStamp/1e3,.001);e.page.x=t.page.x/n,e.page.y=t.page.y/n,e.client.x=t.client.x/n,e.client.y=t.client.y/n,e.timeStamp=n}function Bt(e){e.page.x=0,e.page.y=0,e.client.x=0,e.client.y=0}function _t(e){return e instanceof d.Event||e instanceof d.Touch}function q(e,t,n){return n=n||{},e=e||"page",n.x=t[e+"X"],n.y=t[e+"Y"],n}function Wt(e,t){return t=t||{x:0,y:0},y.isOperaMobile&&_t(e)?(q("screen",e,t),t.x+=window.scrollX,t.y+=window.scrollY):q("page",e,t),t}function Nt(e,t){return t=t||{},y.isOperaMobile&&_t(e)?q("screen",e,t):q("client",e,t),t}function z(e){return c.number(e.pointerId)?e.pointerId:e.identifier}function Vt(e,t,n){const i=t.length>1?wt(t):t[0];Wt(i,e.page),Nt(i,e.client),e.timeStamp=n}function et(e){const t=[];return c.array(e)?(t[0]=e[0],t[1]=e[1]):e.type==="touchend"?e.touches.length===1?(t[0]=e.touches[0],t[1]=e.changedTouches[0]):e.touches.length===0&&(t[0]=e.changedTouches[0],t[1]=e.changedTouches[1]):(t[0]=e.touches[0],t[1]=e.touches[1]),t}function wt(e){const t={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0};for(const n of e)for(const i in t)t[i]+=n[i];for(const n in t)t[n]/=e.length;return t}function Ht(e){if(!e.length)return null;const t=et(e),n=Math.min(t[0].pageX,t[1].pageX),i=Math.min(t[0].pageY,t[1].pageY),s=Math.max(t[0].pageX,t[1].pageX),o=Math.max(t[0].pageY,t[1].pageY);return{x:n,y:i,left:n,top:i,right:s,bottom:o,width:s-n,height:o-i}}function Zt(e,t){const n=t+"X",i=t+"Y",s=et(e),o=s[0][n]-s[1][n],r=s[0][i]-s[1][i];return tt(o,r)}function Jt(e,t){const n=t+"X",i=t+"Y",s=et(e),o=s[1][n]-s[0][n],r=s[1][i]-s[0][i];return 180*Math.atan2(r,o)/Math.PI}function Qt(e){return c.string(e.pointerType)?e.pointerType:c.number(e.pointerType)?[void 0,void 0,"touch","pen","mouse"][e.pointerType]:/touch/.test(e.type||"")||e instanceof d.Touch?"touch":"mouse"}function Tt(e){const t=c.func(e.composedPath)?e.composedPath():e.path;return[ct(t?t[0]:e.target),ct(e.currentTarget)]}function k(){return{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}}function te(e){var t;const n=[],i={},s=[],o={add:r,remove:a,addDelegate:l,removeDelegate:p,delegateListener:E,delegateUseCapture:x,delegatedEvents:i,documents:s,targets:n,supportsOptions:!1,supportsPassive:!1};(t=e.document)==null||t.createElement("div").addEventListener("test",null,{get capture(){return o.supportsOptions=!0},get passive(){return o.supportsPassive=!0}}),e.events=o;function r(u,h,m,P){if(!u.addEventListener)return;const _=L(P);let v=G(n,g=>g.eventTarget===u);v||(v={eventTarget:u,events:{}},n.push(v)),v.events[h]||(v.events[h]=[]),G(v.events[h],g=>g.func===m&&U(g.options,_))||(u.addEventListener(h,m,o.supportsOptions?_:_.capture),v.events[h].push({func:m,options:_}))}function a(u,h,m,P){if(!u.addEventListener||!u.removeEventListener)return;const _=N(n,f=>f.eventTarget===u),v=n[_];if(!v||!v.events)return;if(h==="all"){for(h in v.events)v.events.hasOwnProperty(h)&&a(u,h,"all");return}let g=!1;const b=v.events[h];if(b)if(m==="all"){for(let f=b.length-1;f>=0;f--){const w=b[f];a(u,h,w.func,w.options)}return}else{const f=L(P);for(let w=0;w<b.length;w++){const S=b[w];if(S.func===m&&U(S.options,f)){u.removeEventListener(h,m,o.supportsOptions?f:f.capture),b.splice(w,1),b.length===0&&(delete v.events[h],g=!0);break}}}g&&!Object.keys(v.events).length&&n.splice(_,1)}function l(u,h,m,P,_){const v=L(_);if(!i[m]){i[m]=[];for(const f of s)r(f,m,E),r(f,m,x,!0)}const g=i[m];let b=G(g,f=>f.selector===u&&f.context===h);b||(b={selector:u,context:h,listeners:[]},g.push(b)),b.listeners.push({func:P,options:v})}function p(u,h,m,P,_){const v=L(_),g=i[m];let b=!1,f;if(g)for(f=g.length-1;f>=0;f--){const w=g[f];if(w.selector===u&&w.context===h){const{listeners:S}=w;for(let $=S.length-1;$>=0;$--){const F=S[$];if(F.func===P&&U(F.options,v)){S.splice($,1),S.length||(g.splice(f,1),a(h,m,E),a(h,m,x,!0)),b=!0;break}}if(b)break}}}function E(u,h){const m=L(h),P=new ee(u),_=i[u.type],[v]=Tt(u);let g=v;for(;c.element(g);){for(let b=0;b<_.length;b++){const f=_[b],{selector:w,context:S}=f;if(R(g,w)&&O(S,v)&&O(S,g)){const{listeners:$}=f;P.currentTarget=g;for(const F of $)U(F.options,m)&&F.func(P)}}g=j(g)}}function x(u){return E.call(this,u,!0)}return o}class ee{constructor(t){this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=t,xt(this,t)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}function L(e){return c.object(e)?{capture:!!e.capture,passive:!!e.passive}:{capture:!!e,passive:!1}}function U(e,t){return e===t?!0:typeof e=="boolean"?!!t.capture===e&&!t.passive:!!e.capture==!!t.capture&&!!e.passive==!!t.passive}var ne={id:"events",install:te};const ie=function(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):c.bool(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault};function se(e,t,n){const i=e.options.preventDefault;if(i!=="never"){if(i==="always"){n.preventDefault();return}if(t.events.supportsPassive&&/^touch(start|move)$/.test(n.type)){const s=C(n.target).document,o=t.getDocOptions(s);if(!(o&&o.events)||o.events.passive!==!1)return}/^(mouse|pointer|touch)*(down|start)/i.test(n.type)||c.element(n.target)&&R(n.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||n.preventDefault()}}function oe(e){let{interaction:t,event:n}=e;t.interactable&&t.interactable.checkAndPreventDefault(n)}function re(e){const{Interactable:t}=e;t.prototype.preventDefault=ie,t.prototype.checkAndPreventDefault=function(n){return se(this,e,n)},e.interactions.docEvents.push({type:"dragstart",listener(n){for(const i of e.interactions.list)if(i.element&&(i.element===n.target||O(i.element,n.target))){i.interactable.checkAndPreventDefault(n);return}}})}var ce={id:"core/interactablePreventDefault",install:re,listeners:["down","move","up","cancel"].reduce((e,t)=>(e[`interactions:${t}`]=oe,e),{})};function Z(e,t){let n=!1;return function(){return n||(X.console.warn(t),n=!0),e.apply(this,arguments)}}function ae(e,t){return e.name=t.name,e.axis=t.axis,e.edges=t.edges,e}function le(e,t,n){return e==="parent"?j(n):e==="self"?t.getRect(n):Et(n,e)}function ue(e,t,n,i){let s=e;return c.string(s)?s=le(s,t,n):c.func(s)&&(s=s(...i)),c.element(s)&&(s=Q(s)),s}function he(e){return e&&{x:"x"in e?e.x:e.left,y:"y"in e?e.y:e.top}}function pe(e,t,n){e.left&&(t.left+=n.x),e.right&&(t.right+=n.x),e.top&&(t.top+=n.y),e.bottom&&(t.bottom+=n.y),t.width=t.right-t.left,t.height=t.bottom-t.top}function fe(e,t,n){const i=n&&e.options[n],o=i&&i.origin||e.options.origin,r=ue(o,e,t,[e&&t]);return he(r)||{x:0,y:0}}class Pt{constructor(t){this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=t}preventDefault(){}stopPropagation(){this.propagationStopped=!0}stopImmediatePropagation(){this.immediatePropagationStopped=this.propagationStopped=!0}}Object.defineProperty(Pt.prototype,"interaction",{get(){return this._interaction._proxy},set(){}});const St={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}};class nt extends Pt{constructor(t,n,i,s,o,r,a){super(t),this.relatedTarget=null,this.screenX=void 0,this.screenY=void 0,this.button=void 0,this.buttons=void 0,this.ctrlKey=void 0,this.shiftKey=void 0,this.altKey=void 0,this.metaKey=void 0,this.page=void 0,this.client=void 0,this.delta=void 0,this.rect=void 0,this.x0=void 0,this.y0=void 0,this.t0=void 0,this.dt=void 0,this.duration=void 0,this.clientX0=void 0,this.clientY0=void 0,this.velocity=void 0,this.speed=void 0,this.swipe=void 0,this.axes=void 0,this.preEnd=void 0,o=o||t.element;const l=t.interactable,p=(l&&l.options||St).deltaSource,E=fe(l,o,i),x=s==="start",u=s==="end",h=x?this:t.prevEvent,m=x?t.coords.start:u?{page:h.page,client:h.client,timeStamp:t.coords.cur.timeStamp}:t.coords.cur;this.page=T({},m.page),this.client=T({},m.client),this.rect=T({},t.rect),this.timeStamp=m.timeStamp,u||(this.page.x-=E.x,this.page.y-=E.y,this.client.x-=E.x,this.client.y-=E.y),this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.button=n.button,this.buttons=n.buttons,this.target=o,this.currentTarget=o,this.preEnd=r,this.type=a||i+(s||""),this.interactable=l,this.t0=x?t.pointers[t.pointers.length-1].downTime:h.t0,this.x0=t.coords.start.page.x-E.x,this.y0=t.coords.start.page.y-E.y,this.clientX0=t.coords.start.client.x-E.x,this.clientY0=t.coords.start.client.y-E.y,x||u?this.delta={x:0,y:0}:this.delta={x:this[p].x-h[p].x,y:this[p].y-h[p].y},this.dt=t.coords.delta.timeStamp,this.duration=this.timeStamp-this.t0,this.velocity=T({},t.coords.velocity[p]),this.speed=tt(this.velocity.x,this.velocity.y),this.swipe=u||s==="inertiastart"?this.getSwipe():null}getSwipe(){const t=this._interaction;if(t.prevEvent.speed<600||this.timeStamp-t.prevEvent.timeStamp>150)return null;let n=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;const i=22.5;n<0&&(n+=360);const s=135-i<=n&&n<225+i,o=225-i<=n&&n<315+i,r=!s&&(315-i<=n||n<45+i),a=!o&&45-i<=n&&n<135+i;return{up:o,down:a,left:s,right:r,angle:n,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}}preventDefault(){}stopImmediatePropagation(){this.immediatePropagationStopped=this.propagationStopped=!0}stopPropagation(){this.propagationStopped=!0}}Object.defineProperties(nt.prototype,{pageX:{get(){return this.page.x},set(e){this.page.x=e}},pageY:{get(){return this.page.y},set(e){this.page.y=e}},clientX:{get(){return this.client.x},set(e){this.client.x=e}},clientY:{get(){return this.client.y},set(e){this.client.y=e}},dx:{get(){return this.delta.x},set(e){this.delta.x=e}},dy:{get(){return this.delta.y},set(e){this.delta.y=e}},velocityX:{get(){return this.velocity.x},set(e){this.velocity.x=e}},velocityY:{get(){return this.velocity.y},set(e){this.velocity.y=e}}});class de{constructor(t,n,i,s,o){this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=t,this.pointer=n,this.event=i,this.downTime=s,this.downTarget=o}}let me=function(e){return e.interactable="",e.element="",e.prepared="",e.pointerIsDown="",e.pointerWasMoved="",e._proxy="",e}({}),ve=function(e){return e.start="",e.move="",e.end="",e.stop="",e.interacting="",e}({}),ge=0;class ye{get pointerMoveTolerance(){return 1}constructor(t){this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=Z(function(o){this.move(o)},"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:k(),prev:k(),cur:k(),delta:k(),velocity:k()},this._id=ge++;let{pointerType:n,scopeFire:i}=t;this._scopeFire=i,this.pointerType=n;const s=this;this._proxy={};for(const o in me)Object.defineProperty(this._proxy,o,{get(){return s[o]}});for(const o in ve)Object.defineProperty(this._proxy,o,{value:function(){return s[o](...arguments)}});this._scopeFire("interactions:new",{interaction:this})}pointerDown(t,n,i){const s=this.updatePointer(t,n,i,!0),o=this.pointers[s];this._scopeFire("interactions:down",{pointer:t,event:n,eventTarget:i,pointerIndex:s,pointerInfo:o,type:"down",interaction:this})}start(t,n,i){return this.interacting()||!this.pointerIsDown||this.pointers.length<(t.name==="gesture"?2:1)||!n.options[t.name].enabled?!1:(ae(this.prepared,t),this.interactable=n,this.element=i,this.rect=n.getRect(i),this.edges=this.prepared.edges?T({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}pointerMove(t,n,i){!this.simulation&&!(this.modification&&this.modification.endResult)&&this.updatePointer(t,n,i,!1);const s=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;let o,r;this.pointerIsDown&&!this.pointerWasMoved&&(o=this.coords.cur.client.x-this.coords.start.client.x,r=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=tt(o,r)>this.pointerMoveTolerance);const a=this.getPointerIndex(t),l={pointer:t,pointerIndex:a,pointerInfo:this.pointers[a],event:n,type:"move",eventTarget:i,dx:o,dy:r,duplicate:s,interaction:this};s||zt(this.coords.velocity,this.coords.delta),this._scopeFire("interactions:move",l),!s&&!this.simulation&&(this.interacting()&&(l.type=null,this.move(l)),this.pointerWasMoved&&V(this.coords.prev,this.coords.cur))}move(t){(!t||!t.event)&&Bt(this.coords.delta),t=T({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},t||{}),t.phase="move",this._doPhase(t)}pointerUp(t,n,i,s){let o=this.getPointerIndex(t);o===-1&&(o=this.updatePointer(t,n,i,!1));const r=/cancel$/i.test(n.type)?"cancel":"up";this._scopeFire(`interactions:${r}`,{pointer:t,pointerIndex:o,pointerInfo:this.pointers[o],event:n,eventTarget:i,type:r,curEventTarget:s,interaction:this}),this.simulation||this.end(n),this.removePointer(t,n)}documentBlur(t){this.end(t),this._scopeFire("interactions:blur",{event:t,type:"blur",interaction:this})}end(t){this._ending=!0,t=t||this._latestPointer.event;let n;this.interacting()&&(n=this._doPhase({event:t,interaction:this,phase:"end"})),this._ending=!1,n===!0&&this.stop()}currentAction(){return this._interacting?this.prepared.name:null}interacting(){return this._interacting}stop(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}getPointerIndex(t){const n=z(t);return this.pointerType==="mouse"||this.pointerType==="pen"?this.pointers.length-1:N(this.pointers,i=>i.id===n)}getPointerInfo(t){return this.pointers[this.getPointerIndex(t)]}updatePointer(t,n,i,s){const o=z(t);let r=this.getPointerIndex(t),a=this.pointers[r];return s=s===!1?!1:s||/(down|start)$/i.test(n.type),a?a.pointer=t:(a=new de(o,t,n,null,null),r=this.pointers.length,this.pointers.push(a)),Vt(this.coords.cur,this.pointers.map(l=>l.pointer),this._now()),qt(this.coords.delta,this.coords.prev,this.coords.cur),s&&(this.pointerIsDown=!0,a.downTime=this.coords.cur.timeStamp,a.downTarget=i,xt(this.downPointer,t),this.interacting()||(V(this.coords.start,this.coords.cur),V(this.coords.prev,this.coords.cur),this.downEvent=n,this.pointerWasMoved=!1)),this._updateLatestPointer(t,n,i),this._scopeFire("interactions:update-pointer",{pointer:t,event:n,eventTarget:i,down:s,pointerInfo:a,pointerIndex:r,interaction:this}),r}removePointer(t,n){const i=this.getPointerIndex(t);if(i===-1)return;const s=this.pointers[i];this._scopeFire("interactions:remove-pointer",{pointer:t,event:n,eventTarget:null,pointerIndex:i,pointerInfo:s,interaction:this}),this.pointers.splice(i,1),this.pointerIsDown=!1}_updateLatestPointer(t,n,i){this._latestPointer.pointer=t,this._latestPointer.event=n,this._latestPointer.eventTarget=i}destroy(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}_createPreparedEvent(t,n,i,s){return new nt(this,t,this.prepared.name,n,this.element,i,s)}_fireEvent(t){var n;(n=this.interactable)==null||n.fire(t),(!this.prevEvent||t.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=t)}_doPhase(t){const{event:n,phase:i,preEnd:s,type:o}=t,{rect:r}=this;if(r&&i==="move"&&(pe(this.edges,r,this.coords.delta[this.interactable.options.deltaSource]),r.width=r.right-r.left,r.height=r.bottom-r.top),this._scopeFire(`interactions:before-action-${i}`,t)===!1)return!1;const l=t.iEvent=this._createPreparedEvent(n,i,s,o);return this._scopeFire(`interactions:action-${i}`,t),i==="start"&&(this.prevEvent=l),this._fireEvent(l),this._scopeFire(`interactions:after-action-${i}`,t),!0}_now(){return Date.now()}}const J={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search(e){for(const t of J.methodOrder){const n=J[t](e);if(n)return n}return null},simulationResume(e){let{pointerType:t,eventType:n,eventTarget:i,scope:s}=e;if(!/down|start/i.test(n))return null;for(const o of s.interactions.list){let r=i;if(o.simulation&&o.simulation.allowResume&&o.pointerType===t)for(;r;){if(r===o.element)return o;r=j(r)}}return null},mouseOrPen(e){let{pointerId:t,pointerType:n,eventType:i,scope:s}=e;if(n!=="mouse"&&n!=="pen")return null;let o;for(const r of s.interactions.list)if(r.pointerType===n){if(r.simulation&&!lt(r,t))continue;if(r.interacting())return r;o||(o=r)}if(o)return o;for(const r of s.interactions.list)if(r.pointerType===n&&!(/down/i.test(i)&&r.simulation))return r;return null},hasPointer(e){let{pointerId:t,scope:n}=e;for(const i of n.interactions.list)if(lt(i,t))return i;return null},idle(e){let{pointerType:t,scope:n}=e;for(const i of n.interactions.list){if(i.pointers.length===1){const s=i.interactable;if(s&&!(s.options.gesture&&s.options.gesture.enabled))continue}else if(i.pointers.length>=2)continue;if(!i.interacting()&&t===i.pointerType)return i}return null}};function lt(e,t){return e.pointers.some(n=>{let{id:i}=n;return i===t})}const It=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function Ee(e){const t={};for(const o of It)t[o]=Dt(o,e);const n=y.pEventTypes;let i;d.PointerEvent?i=[{type:n.down,listener:s},{type:n.down,listener:t.pointerDown},{type:n.move,listener:t.pointerMove},{type:n.up,listener:t.pointerUp},{type:n.cancel,listener:t.pointerUp}]:i=[{type:"mousedown",listener:t.pointerDown},{type:"mousemove",listener:t.pointerMove},{type:"mouseup",listener:t.pointerUp},{type:"touchstart",listener:s},{type:"touchstart",listener:t.pointerDown},{type:"touchmove",listener:t.pointerMove},{type:"touchend",listener:t.pointerUp},{type:"touchcancel",listener:t.pointerUp}],i.push({type:"blur",listener(o){for(const r of e.interactions.list)r.documentBlur(o)}}),e.prevTouchTime=0,e.Interaction=class extends ye{get pointerMoveTolerance(){return e.interactions.pointerMoveTolerance}set pointerMoveTolerance(o){e.interactions.pointerMoveTolerance=o}_now(){return e.now()}},e.interactions={list:[],new(o){o.scopeFire=(a,l)=>e.fire(a,l);const r=new e.Interaction(o);return e.interactions.list.push(r),r},listeners:t,docEvents:i,pointerMoveTolerance:1};function s(){for(const o of e.interactions.list)if(!(!o.pointerIsDown||o.pointerType!=="touch"||o._interacting))for(const r of o.pointers)e.documents.some(a=>{let{doc:l}=a;return O(l,r.downTarget)})||o.removePointer(r.pointer,r.event)}e.usePlugin(ce)}function Dt(e,t){return function(n){const i=t.interactions.list,s=Qt(n),[o,r]=Tt(n),a=[];if(/^touch/.test(n.type)){t.prevTouchTime=t.now();for(const l of n.changedTouches){const p=l,E=z(p),x={pointer:p,pointerId:E,pointerType:s,eventType:n.type,eventTarget:o,curEventTarget:r,scope:t},u=ut(x);a.push([x.pointer,x.eventTarget,x.curEventTarget,u])}}else{let l=!1;if(!y.supportsPointerEvent&&/mouse/.test(n.type)){for(let p=0;p<i.length&&!l;p++)l=i[p].pointerType!=="mouse"&&i[p].pointerIsDown;l=l||t.now()-t.prevTouchTime<500||n.timeStamp===0}if(!l){const p={pointer:n,pointerId:z(n),pointerType:s,eventType:n.type,curEventTarget:r,eventTarget:o,scope:t},E=ut(p);a.push([p.pointer,p.eventTarget,p.curEventTarget,E])}}for(const[l,p,E,x]of a)x[e](l,n,p,E)}}function ut(e){const{pointerType:t,scope:n}=e,s={interaction:J.search(e),searchDetails:e};return n.fire("interactions:find",s),s.interaction||n.interactions.new({pointerType:t})}function H(e,t){let{doc:n,scope:i,options:s}=e;const{interactions:{docEvents:o},events:r}=i,a=r[t];i.browser.isIOS&&!s.events&&(s.events={passive:!1});for(const p in r.delegatedEvents)a(n,p,r.delegateListener),a(n,p,r.delegateUseCapture,!0);const l=s&&s.events;for(const{type:p,listener:E}of o)a(n,p,E,l)}const be={id:"core/interactions",install:Ee,listeners:{"scope:add-document":e=>H(e,"add"),"scope:remove-document":e=>H(e,"remove"),"interactable:unset":(e,t)=>{let{interactable:n}=e;for(let i=t.interactions.list.length-1;i>=0;i--){const s=t.interactions.list[i];s.interactable===n&&(s.stop(),t.fire("interactions:destroy",{interaction:s}),s.destroy(),t.interactions.list.length>2&&t.interactions.list.splice(i,1))}}},onDocSignal:H,doOnInteractions:Dt,methodNames:It};function B(e,t){if(t.phaselessTypes[e])return!0;for(const n in t.map)if(e.indexOf(n)===0&&e.substr(n.length)in t.phases)return!0;return!1}var D=function(e){return e[e.On=0]="On",e[e.Off=1]="Off",e}(D||{});class xe{get _defaults(){return{base:{},perAction:{},actions:{}}}constructor(t,n,i,s){this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new yt,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=n.actions,this.target=t,this._context=n.context||i,this._win=C(at(t)?this._context:t),this._doc=this._win.document,this._scopeEvents=s,this.set(n)}setOnEvents(t,n){return c.func(n.onstart)&&this.on(`${t}start`,n.onstart),c.func(n.onmove)&&this.on(`${t}move`,n.onmove),c.func(n.onend)&&this.on(`${t}end`,n.onend),c.func(n.oninertiastart)&&this.on(`${t}inertiastart`,n.oninertiastart),this}updatePerActionListeners(t,n,i){var s;const o=(s=this._actions.map[t])==null?void 0:s.filterEventType,r=a=>(o==null||o(a))&&B(a,this._actions);(c.array(n)||c.object(n))&&this._onOff(D.Off,t,n,void 0,r),(c.array(i)||c.object(i))&&this._onOff(D.On,t,i,void 0,r)}setPerAction(t,n){const i=this._defaults;for(const s in n){const o=s,r=this.options[t],a=n[o];o==="listeners"&&this.updatePerActionListeners(t,r.listeners,a),c.array(a)?r[o]=gt(a):c.plainObject(a)?(r[o]=T(r[o]||{},K(a)),c.object(i.perAction[o])&&"enabled"in i.perAction[o]&&(r[o].enabled=a.enabled!==!1)):c.bool(a)&&c.object(i.perAction[o])?r[o].enabled=a:r[o]=a}}getRect(t){return t=t||(c.element(this.target)?this.target:null),c.string(this.target)&&(t=t||this._context.querySelector(this.target)),Q(t)}rectChecker(t){return c.func(t)?(this.getRect=n=>{const i=T({},t.apply(this,n));return"width"in i||(i.width=i.right-i.left,i.height=i.bottom-i.top),i},this):t===null?(delete this.getRect,this):this.getRect}_backCompatOption(t,n){if(at(n)||c.object(n)){this.options[t]=n;for(const i in this._actions.map)this.options[i][t]=n;return this}return this.options[t]}origin(t){return this._backCompatOption("origin",t)}deltaSource(t){return t==="page"||t==="client"?(this.options.deltaSource=t,this):this.options.deltaSource}getAllElements(){const{target:t}=this;return c.string(t)?Array.from(this._context.querySelectorAll(t)):c.func(t)&&t.getAllElements?t.getAllElements():c.element(t)?[t]:[]}context(){return this._context}inContext(t){return this._context===t.ownerDocument||O(this._context,t)}testIgnoreAllow(t,n,i){return!this.testIgnore(t.ignoreFrom,n,i)&&this.testAllow(t.allowFrom,n,i)}testAllow(t,n,i){return t?c.element(i)?c.string(t)?rt(i,t,n):c.element(t)?O(t,i):!1:!1:!0}testIgnore(t,n,i){return!t||!c.element(i)?!1:c.string(t)?rt(i,t,n):c.element(t)?O(t,i):!1}fire(t){return this.events.fire(t),this}_onOff(t,n,i,s,o){c.object(n)&&!c.array(n)&&(s=i,i=null);const r=A(n,i,o);for(let a in r){a==="wheel"&&(a=y.wheelEvent);for(const l of r[a])B(a,this._actions)?this.events[t===D.On?"on":"off"](a,l):c.string(this.target)?this._scopeEvents[t===D.On?"addDelegate":"removeDelegate"](this.target,this._context,a,l,s):this._scopeEvents[t===D.On?"add":"remove"](this.target,a,l,s)}return this}on(t,n,i){return this._onOff(D.On,t,n,i)}off(t,n,i){return this._onOff(D.Off,t,n,i)}set(t){const n=this._defaults;c.object(t)||(t={}),this.options=K(n.base);for(const i in this._actions.methodDict){const s=i,o=this._actions.methodDict[s];this.options[s]={},this.setPerAction(s,T(T({},n.perAction),n.actions[s])),this[o](t[s])}for(const i in t){if(i==="getRect"){this.rectChecker(t.getRect);continue}c.func(this[i])&&this[i](t[i])}return this}unset(){if(c.string(this.target))for(const t in this._scopeEvents.delegatedEvents){const n=this._scopeEvents.delegatedEvents[t];for(let i=n.length-1;i>=0;i--){const{selector:s,context:o,listeners:r}=n[i];s===this.target&&o===this._context&&n.splice(i,1);for(let a=r.length-1;a>=0;a--)this._scopeEvents.removeDelegate(this.target,this._context,t,r[a][0],r[a][1])}}else this._scopeEvents.remove(this.target,"all")}}class _e{constructor(t){this.list=[],this.selectorMap={},this.scope=void 0,this.scope=t,t.addListeners({"interactable:unset":n=>{let{interactable:i}=n;const{target:s}=i,o=c.string(s)?this.selectorMap[s]:s[this.scope.id],r=N(o,a=>a===i);o.splice(r,1)}})}new(t,n){n=T(n||{},{actions:this.scope.actions});const i=new this.scope.Interactable(t,n,this.scope.document,this.scope.events);return this.scope.addDocument(i._doc),this.list.push(i),c.string(t)?(this.selectorMap[t]||(this.selectorMap[t]=[]),this.selectorMap[t].push(i)):(i.target[this.scope.id]||Object.defineProperty(t,this.scope.id,{value:[],configurable:!0}),t[this.scope.id].push(i)),this.scope.fire("interactable:new",{target:t,options:n,interactable:i,win:this.scope._win}),i}getExisting(t,n){const i=n&&n.context||this.scope.document,s=c.string(t),o=s?this.selectorMap[t]:t[this.scope.id];if(o)return G(o,r=>r._context===i&&(s||r.inContext(t)))}forEachMatch(t,n){for(const i of this.list){let s;if((c.string(i.target)?c.element(t)&&R(t,i.target):t===i.target)&&i.inContext(t)&&(s=n(i)),s!==void 0)return s}}}function we(e){const t=(n,i)=>{let s=e.interactables.getExisting(n,i);return s||(s=e.interactables.new(n,i),s.events.global=t.globalEvents),s};return t.getPointerAverage=wt,t.getTouchBBox=Ht,t.getTouchDistance=Zt,t.getTouchAngle=Jt,t.getElementRect=Q,t.getElementClientRect=bt,t.matchesSelector=R,t.closest=Et,t.globalEvents={},t.version="1.10.27",t.scope=e,t.use=function(n,i){return this.scope.usePlugin(n,i),this},t.isSet=function(n,i){return!!this.scope.interactables.get(n,i&&i.context)},t.on=Z(function(i,s,o){if(c.string(i)&&i.search(" ")!==-1&&(i=i.trim().split(/ +/)),c.array(i)){for(const r of i)this.on(r,s,o);return this}if(c.object(i)){for(const r in i)this.on(r,i[r],s);return this}return B(i,this.scope.actions)?this.globalEvents[i]?this.globalEvents[i].push(s):this.globalEvents[i]=[s]:this.scope.events.add(this.scope.document,i,s,{options:o}),this},"The interact.on() method is being deprecated"),t.off=Z(function(i,s,o){if(c.string(i)&&i.search(" ")!==-1&&(i=i.trim().split(/ +/)),c.array(i)){for(const r of i)this.off(r,s,o);return this}if(c.object(i)){for(const r in i)this.off(r,i[r],s);return this}if(B(i,this.scope.actions)){let r;i in this.globalEvents&&(r=this.globalEvents[i].indexOf(s))!==-1&&this.globalEvents[i].splice(r,1)}else this.scope.events.remove(this.scope.document,i,s,o);return this},"The interact.off() method is being deprecated"),t.debug=function(){return this.scope},t.supportsTouch=function(){return y.supportsTouch},t.supportsPointerEvent=function(){return y.supportsPointerEvent},t.stop=function(){for(const n of this.scope.interactions.list)n.stop();return this},t.pointerMoveTolerance=function(n){return c.number(n)?(this.scope.interactions.pointerMoveTolerance=n,this):this.scope.interactions.pointerMoveTolerance},t.addDocument=function(n,i){this.scope.addDocument(n,i)},t.removeDocument=function(n){this.scope.removeDocument(n)},t}class Te{constructor(){this.id=`__interact_scope_${Math.floor(Math.random()*100)}`,this.isInitialized=!1,this.listenerMaps=[],this.browser=y,this.defaults=K(St),this.Eventable=yt,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=we(this),this.InteractEvent=nt,this.Interactable=void 0,this.interactables=new _e(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=n=>this.removeDocument(n.target);const t=this;this.Interactable=class extends xe{get _defaults(){return t.defaults}set(n){return super.set(n),t.fire("interactable:set",{options:n,interactable:this}),this}unset(){super.unset();const n=t.interactables.list.indexOf(this);n<0||(t.interactables.list.splice(n,1),t.fire("interactable:unset",{interactable:this}))}}}addListeners(t,n){this.listenerMaps.push({id:n,map:t})}fire(t,n){for(const{map:{[t]:i}}of this.listenerMaps)if(i&&i(n,this,t)===!1)return!1}init(t){return this.isInitialized?this:Pe(this,t)}pluginIsInstalled(t){const{id:n}=t;return n?!!this._plugins.map[n]:this._plugins.list.indexOf(t)!==-1}usePlugin(t,n){if(!this.isInitialized)return this;if(this.pluginIsInstalled(t))return this;if(t.id&&(this._plugins.map[t.id]=t),this._plugins.list.push(t),t.install&&t.install(this,n),t.listeners&&t.before){let i=0;const s=this.listenerMaps.length,o=t.before.reduce((r,a)=>(r[a]=!0,r[ht(a)]=!0,r),{});for(;i<s;i++){const r=this.listenerMaps[i].id;if(r&&(o[r]||o[ht(r)]))break}this.listenerMaps.splice(i,0,{id:t.id,map:t.listeners})}else t.listeners&&this.listenerMaps.push({id:t.id,map:t.listeners});return this}addDocument(t,n){if(this.getDocIndex(t)!==-1)return!1;const i=C(t);n=n?T({},n):{},this.documents.push({doc:t,options:n}),this.events.documents.push(t),t!==this.document&&this.events.add(i,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:t,window:i,scope:this,options:n})}removeDocument(t){const n=this.getDocIndex(t),i=C(t),s=this.documents[n].options;this.events.remove(i,"unload",this.onWindowUnload),this.documents.splice(n,1),this.events.documents.splice(n,1),this.fire("scope:remove-document",{doc:t,window:i,scope:this,options:s})}getDocIndex(t){for(let n=0;n<this.documents.length;n++)if(this.documents[n].doc===t)return n;return-1}getDocOptions(t){const n=this.getDocIndex(t);return n===-1?null:this.documents[n].options}now(){return(this.window.Date||Date).now()}}function Pe(e,t){return e.isInitialized=!0,c.window(t)&&dt(t),d.init(t),y.init(t),Ut.init(t),e.window=t,e.document=t.document,e.usePlugin(be),e.usePlugin(ne),e}function ht(e){return e&&e.replace(/\/.*$/,"")}const Mt=new Te,Ie=Mt.interactStatic,Se=typeof globalThis<"u"?globalThis:window;Mt.init(Se);export{Ie as i};
