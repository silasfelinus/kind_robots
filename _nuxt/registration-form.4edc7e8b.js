import q from"./Icon.c5da5c33.js";import{d as O,W as X,r as s,E as V,b as r,c as n,C as f,e as t,N,f as c,Y as P,Z as L,t as C,a_ as M,g as I,n as $,X as j,a0 as E,p as G,i as J,k as Q}from"./entry.48ebb39a.js";const U=_=>(G("data-v-560b0736"),_=_(),J(),_),ee={class:"bg-base-200 flex flex-col items-center p-4 rounded-2xl"},te=U(()=>t("h1",{class:"text-3xl font-bold text-primary mb-4"},"Kind Robots",-1)),se={key:0,class:"text-lg text-info mb-4"},ae=U(()=>t("a",{href:"/dashboard",class:"text-accent"},"go to the dashboard",-1)),oe=["onSubmit"],le={key:0},re=U(()=>t("h1",{class:"text-4xl font-bold text-primary mb-4"},"Pick a Cool Username",-1)),ne={class:"relative mb-4"},ie={key:0,class:"absolute text-xs text-warning right-2 bottom-1"},ue={key:1},de={class:"text-2xl font-semibold text-primary mb-2"},ce=U(()=>t("p",{class:"text-lg mb-2"},"Optional details:",-1)),ve={class:"relative group mb-4"},me={class:"relative group mb-4"},pe=["type"],be={class:"absolute inset-y-0 right-0 flex items-center pr-3"},ge={key:0,class:"text-xs text-warning right-2 bottom-1 absolute"},fe={key:0,class:"relative group mb-4"},_e=["type"],xe={class:"absolute inset-y-0 right-0 flex items-center pr-3"},he={key:1,class:"my-2 px-4 py-2 text-lg text-info bg-info-light rounded"},ye={key:2,class:"my-2 px-4 py-2 text-lg text-warning bg-warning-light rounded"},we=["disabled"],ke={key:0},Pe={key:1},Ce=O({__name:"registration-form",setup(_){const m=X();m.initializeUser();const d=s(""),S=s(""),a=s(""),x=s(""),g=s(!1),h=s(""),v=s(""),y=s(!1),R=s(""),w=s(!1),i=s(""),k=s(1),p=s(!1);V(()=>a.value&&!i.value);const b=s(!1),T=()=>{if(!a.value){i.value="",b.value=!1;return}const o=/^.{8,}$/,e=/\d/,u=/[a-zA-Z]/;o.test(a.value)?e.test(a.value)?u.test(a.value)?(i.value="",b.value=!0):(i.value="Include at least one letter",b.value=!1):(i.value="Include at least one number",b.value=!1):(i.value="At least 8 characters",b.value=!1)},z=()=>{a.value&&a.value!==x.value?i.value="Passwords do not match":i.value=""},A=s(""),B=async()=>{try{const o=await m.getUsernames();g.value=o.includes(d.value),g.value?v.value=`Username "${d.value}" already exists.`:v.value=""}catch(o){const{message:e}=E(o);v.value=e}},W=o=>{o===2&&(A.value=`Welcome, ${d.value}!`),k.value=o},D=V(()=>d.value&&!g.value&&(k.value===1||(!a.value||!i.value)&&a.value===x.value)),F=()=>{w.value=!w.value},H=()=>{p.value=!p.value},K=V(()=>m.isLoggedIn),Y=()=>{localStorage.removeItem("api_key"),localStorage.removeItem("token")},Z=async()=>{if(D.value){y.value=!0,R.value="Registering user...";try{Y();const o={username:d.value,email:S.value,password:a.value};if((await m.register(o)).success){R.value="Welcome to Kind Robots!",h.value="Welcome to Kind Robots!";try{const u={username:d.value};a.value&&(u.password=a.value),await m.login(u)}catch(u){const{message:l}=E({error:u});v.value=l}}else h.value="",v.value="Registration failed. Please try again."}catch(o){const{message:e}=E({error:o});v.value=e}y.value=!1}};return(o,e)=>{const u=q;return r(),n("div",ee,[te,K.value?(r(),n("div",se,[f(" You are already logged in. Would you like to "),ae,f(" or "),t("a",{href:"#",class:"text-warning",onClick:e[0]||(e[0]=(...l)=>N(m).logout&&N(m).logout(...l))},"log out"),f("? ")])):c("",!0),t("form",{class:"space-y-4 w-full max-w-sm",onSubmit:j(Z,["prevent"])},[k.value===1?(r(),n("div",le,[re,t("div",ne,[P(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>d.value=l),type:"text",placeholder:"Username",required:"",class:"w-full p-2 border rounded text-4xl bg-base-200 placeholder-base-300","aria-label":"Username",autocomplete:"username",onInput:B},null,544),[[L,d.value]]),g.value?(r(),n("p",ie," Username already exists ")):c("",!0)]),d.value&&!g.value?(r(),n("button",{key:0,type:"button",class:"w-full bg-primary text-lg text-base-100 p-2 rounded hover:bg-primary-dark transition duration-300",onClick:e[2]||(e[2]=l=>W(2))}," That's my name! ")):c("",!0)])):c("",!0),k.value===2?(r(),n("div",ue,[t("h2",de,"Welcome, "+C(d.value)+"!",1),t("button",{type:"button",class:"text-md mb-4",onClick:e[3]||(e[3]=l=>W(1))}," I want a different username "),ce,t("div",ve,[P(t("input",{"onUpdate:modelValue":e[4]||(e[4]=l=>S.value=l),type:"email",placeholder:"Email (optional)",class:"w-full p-2 border rounded text-lg bg-base-200 placeholder-base-300","aria-label":"Email",autocomplete:"email"},null,512),[[L,S.value]])]),t("div",me,[P(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.value=l),type:w.value?"text":"password",placeholder:"Password (keep it blank if you prefer)",class:"w-full p-2 border rounded text-lg bg-base-200 placeholder-base-300","aria-label":"Password",autocomplete:"new-password",onInput:T},null,40,pe),[[M,a.value]]),t("div",be,[I(u,{name:"tabler:eye",class:$(w.value?"text-base-300 cursor-pointer hover:text-warning":"text-base-300 cursor-pointer hover:text-success"),title:"Show/Hide Password",onClick:F},null,8,["class"])]),i.value?(r(),n("p",ge,C(i.value),1)):c("",!0)]),b.value?(r(),n("div",fe,[P(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>x.value=l),type:p.value?"text":"password",placeholder:"Confirm Password",class:"w-full p-2 border rounded text-lg bg-base-200 placeholder-base-300","aria-label":"Confirm Password",autocomplete:"new-password",onInput:z},null,40,_e),[[M,x.value]]),t("div",xe,[I(u,{name:p.value?"tabler:eye-off":"tabler:eye",class:$(p.value?"text-base-300 cursor-pointer hover:text-warning":"text-base-300 cursor-pointer hover:text-success"),title:p.value?"Hide Password":"Show Password",onClick:H},null,8,["name","class","title"])])])):c("",!0),h.value?(r(),n("div",he,[I(u,{name:"tabler:info-circle",class:"mr-2"}),f(" "+C(h.value),1)])):c("",!0),v.value?(r(),n("div",ye,[I(u,{name:"tabler:alert-triangle",class:"mr-2"}),f(" "+C(v.value),1)])):c("",!0),t("button",{type:"submit",disabled:!D.value||y.value,class:"w-full bg-primary text-lg text-base-100 p-2 rounded hover:bg-primary-dark transition duration-300"},[y.value?(r(),n("span",ke,"Registering...")):(r(),n("span",Pe,"Register"))],8,we)])):c("",!0)],40,oe)])}}});const Se=Q(Ce,[["__scopeId","data-v-560b0736"]]);export{Se as default};
