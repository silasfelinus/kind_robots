import{d as A,a1 as C,a2 as M,r as u,I,o as T,c as o,e as a,f as e,N as d,g as m,t as f,$ as S,w as b,k as y,h,Y as H,W as w,X as R,a3 as O,a4 as k,E as B,a0 as D}from"./NJWOSLyt.js";const P={class:"flex items-center h-36 w-36 z-50"},$=["src"],q={class:"text-base-200 text-lg mb-1"},z={class:"ml-4"},F={key:0,class:"flex flex-col items-center bg-base-200 p-4 rounded-2xl shadow-lg transition-all duration-300 absolute top-36 left-0"},G={key:0,class:"text-center text-info"},J=e("div",null,"Loading, please wait...",-1),K={key:1,class:"text-center"},W={class:"mb-4"},j={class:"text-lg font-semibold"},X=["autocomplete"],Y=e("label",{for:"login",class:"block text-sm mb-1"},"Login:",-1),Q=e("label",{for:"password",class:"block text-sm mb-1"},"Password:",-1),Z={class:"flex items-center justify-between"},ee=e("label",{for:"stayLoggedIn",class:"text-sm"},"Stay Logged in",-1),te=e("button",{type:"submit",class:"bg-info text-default py-1 px-3 rounded"}," Login ",-1),se={class:"text-center mt-2"},oe={key:3,class:"text-warning mt-2"},re=A({__name:"avatar-banner",setup(ae){const s=C(),r=M(),g=u(""),p=u(""),v=u(!1),_=I(()=>s.isLoggedIn),n=u(!0),c=u(null),U=I(()=>_.value?`Hello, ${s.username} ðŸŽ‰`:"Welcome, Kind Guest"),L=()=>{v.value=!v.value},V=async()=>{r.clearError();try{const t=await r.handleError(()=>s.login(g.value,p.value),k.AUTH_ERROR,"Failed to login. Please try again.");t.success?n.value&&localStorage.setItem("user",JSON.stringify({username:g.value})):(r.setError(k.AUTH_ERROR,t.message),c.value=t.message)}catch(t){c.value="An error occurred during login.",console.error(t)}},N=async()=>{r.clearError();try{await r.handleError(async()=>s.logout(),k.AUTH_ERROR,"Failed to logout. Please try again."),n.value||localStorage.removeItem("user")}catch(t){c.value="An error occurred during logout.",console.error(t)}};return T(()=>{const t=JSON.parse(localStorage.getItem("user")||"null");t&&t.username!=="Kind Guest"&&s.setUser(t)}),(t,l)=>{const x=B,E=D;return o(),a("div",P,[e("div",{class:"flex flex-col items-start cursor-pointer",onClick:L},[d(s).avatarImage?(o(),a("img",{key:0,src:d(s).avatarImage,class:"w-8 h-8 rounded-full mb-2",alt:"Avatar"},null,8,$)):m("",!0),e("span",q,f(U.value),1),_.value?(o(),S(x,{key:1,to:"/dashboard",class:"text-accent underline text-sm"},{default:b(()=>[y(" Dashboard ")]),_:1})):m("",!0),_.value&&d(s).role==="admin"?(o(),S(x,{key:2,to:"/admin",class:"text-accent underline text-sm mt-1"},{default:b(()=>[y(" Admin ")]),_:1})):m("",!0)]),e("div",z,[h(E,{name:"tabler:user",class:"text-base-200 text-2xl cursor-pointer",onClick:L})]),v.value?(o(),a("div",F,[d(s).loading?(o(),a("div",G,[h(E,{name:"tabler:loader",class:"animate-spin text-lg mb-2"}),J])):_.value?(o(),a("div",K,[e("div",W,[e("span",j,"Hello, "+f(d(s).username)+" ðŸŽ‰",1)]),e("button",{class:"bg-warning text-default py-1 px-3 rounded",onClick:N}," Logout ")])):(o(),a("form",{key:2,class:"space-y-4 z-50",autocomplete:n.value?"on":"off",onSubmit:H(V,["prevent"])},[e("div",null,[Y,w(e("input",{id:"login","onUpdate:modelValue":l[0]||(l[0]=i=>g.value=i),type:"text",autocomplete:"username",class:"w-full p-2 border rounded",required:""},null,512),[[R,g.value]])]),e("div",null,[Q,w(e("input",{id:"password","onUpdate:modelValue":l[1]||(l[1]=i=>p.value=i),type:"password",autocomplete:"current-password",class:"w-full p-2 border rounded",required:""},null,512),[[R,p.value]])]),e("div",Z,[e("div",null,[w(e("input",{id:"stayLoggedIn","onUpdate:modelValue":l[2]||(l[2]=i=>n.value=i),type:"checkbox",class:"mr-2"},null,512),[[O,n.value]]),ee]),te]),e("div",se,[h(x,{to:"/register",class:"text-accent underline"},{default:b(()=>[y(" Register ")]),_:1})])],40,X)),c.value?(o(),a("div",oe,f(c.value),1)):m("",!0)])):m("",!0)])}}});export{re as default};
