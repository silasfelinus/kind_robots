import{_ as E}from"./BBxmey6X.js";import z from"./rqtZmSiP.js";import{d as A,Z as D,$ as H,r,H as V,o as W,c as o,e as a,f as e,M as c,g as i,t as b,Y as C,w as h,k as y,h as w,X as $,V as k,W as M,a0 as j,p as q,j as G,l as J}from"./CH0slHa8.js";const d=u=>(q("data-v-265a7ac9"),u=u(),G(),u),K={class:"flex items-center h-36 w-36 z-50"},O=["src"],T={class:"text-base-200 text-lg mb-1"},P={class:"ml-4"},R={key:0,class:"flex flex-col items-center bg-base-200 p-4 rounded-2xl shadow-lg transition-all duration-300 absolute top-36 left-0"},X={key:0,class:"text-center text-info"},Y=d(()=>e("div",null,"Loading, please wait...",-1)),Z={key:1,class:"text-center"},F={class:"mb-4"},Q={class:"text-lg font-semibold"},ee=["autocomplete"],te=d(()=>e("label",{for:"login",class:"block text-sm mb-1"},"Login:",-1)),se=d(()=>e("label",{for:"password",class:"block text-sm mb-1"},"Password:",-1)),oe={class:"flex items-center justify-between"},ae=d(()=>e("label",{for:"stayLoggedIn",class:"text-sm"},"Stay Logged in",-1)),le=d(()=>e("button",{type:"submit",class:"bg-info text-default py-1 px-3 rounded"}," Login ",-1)),ne={class:"text-center mt-2"},re={key:3,class:"text-warning mt-2"},ce=A({__name:"LoginWindow",setup(u){const t=D(),I=H(),m=r(""),v=r(""),x=r(!1),_=r(!0),p=r(null),g=V(()=>t.isLoggedIn),N=V(()=>g.value?`Hello, ${t.username} ðŸŽ‰`:"Welcome, Kind Guest"),L=()=>{x.value=!x.value},U=async()=>{I.clearError();const s=await t.login(m.value,v.value);s.success?_.value&&(localStorage.setItem("user",JSON.stringify({username:m.value})),localStorage.setItem("stayLoggedIn","true")):p.value=s.message},B=async()=>{I.clearError();try{await t.logout(),localStorage.removeItem("user"),localStorage.removeItem("stayLoggedIn")}catch(s){p.value="An error occurred during logout.",console.error(s)}};return W(()=>{const s=JSON.parse(localStorage.getItem("user")||"null");s&&s.username!=="Kind Guest"&&t.setUser(s),t.initializeUser()}),(s,l)=>{const f=E,S=z;return o(),a("div",K,[e("div",{class:"flex flex-col items-start cursor-pointer",onClick:L},[c(t).avatarImage?(o(),a("img",{key:0,src:c(t).avatarImage,class:"w-8 h-8 rounded-full mb-2",alt:"Avatar"},null,8,O)):i("",!0),e("span",T,b(N.value),1),g.value?(o(),C(f,{key:1,to:"/dashboard",class:"text-accent underline text-sm"},{default:h(()=>[y(" Dashboard ")]),_:1})):i("",!0),g.value&&c(t).role==="admin"?(o(),C(f,{key:2,to:"/admin",class:"text-accent underline text-sm mt-1"},{default:h(()=>[y(" Admin ")]),_:1})):i("",!0)]),e("div",P,[w(S,{name:"tabler:user",class:"text-base-200 text-2xl cursor-pointer",onClick:L})]),x.value?(o(),a("div",R,[c(t).loading?(o(),a("div",X,[w(S,{name:"tabler:loader",class:"animate-spin text-lg mb-2"}),Y])):g.value?(o(),a("div",Z,[e("div",F,[e("span",Q,"Hello, "+b(c(t).username)+" ðŸŽ‰",1)]),e("button",{class:"bg-warning text-default py-1 px-3 rounded",onClick:B}," Logout ")])):(o(),a("form",{key:2,class:"space-y-4 z-50",autocomplete:_.value?"on":"off",onSubmit:$(U,["prevent"])},[e("div",null,[te,k(e("input",{id:"login","onUpdate:modelValue":l[0]||(l[0]=n=>m.value=n),type:"text",autocomplete:"username",class:"w-full p-2 border rounded",required:""},null,512),[[M,m.value]])]),e("div",null,[se,k(e("input",{id:"password","onUpdate:modelValue":l[1]||(l[1]=n=>v.value=n),type:"password",autocomplete:"current-password",class:"w-full p-2 border rounded",required:""},null,512),[[M,v.value]])]),e("div",oe,[e("div",null,[k(e("input",{id:"stayLoggedIn","onUpdate:modelValue":l[2]||(l[2]=n=>_.value=n),type:"checkbox",class:"mr-2"},null,512),[[j,_.value]]),ae]),le]),e("div",ne,[w(f,{to:"/register",class:"text-accent underline"},{default:h(()=>[y(" Register ")]),_:1})])],40,ee)),p.value?(o(),a("div",re,b(p.value),1)):i("",!0)])):i("",!0)])}}}),me=J(ce,[["__scopeId","data-v-265a7ac9"]]);export{me as default};
