import{d as B,a1 as z,a2 as A,r,I as V,o as D,c as o,e as a,f as e,N as c,g as i,t as b,$ as N,w as h,k as y,h as w,Y as W,W as k,X as C,a3 as $,E as j,a0 as q,p as G,j as H,l as J}from"./pZiLMi_1.js";const d=u=>(G("data-v-265a7ac9"),u=u(),H(),u),K={class:"flex items-center h-36 w-36 z-50"},O=["src"],T={class:"text-base-200 text-lg mb-1"},P={class:"ml-4"},R={key:0,class:"flex flex-col items-center bg-base-200 p-4 rounded-2xl shadow-lg transition-all duration-300 absolute top-36 left-0"},X={key:0,class:"text-center text-info"},Y=d(()=>e("div",null,"Loading, please wait...",-1)),F={key:1,class:"text-center"},Q={class:"mb-4"},Z={class:"text-lg font-semibold"},ee=["autocomplete"],te=d(()=>e("label",{for:"login",class:"block text-sm mb-1"},"Login:",-1)),se=d(()=>e("label",{for:"password",class:"block text-sm mb-1"},"Password:",-1)),oe={class:"flex items-center justify-between"},ae=d(()=>e("label",{for:"stayLoggedIn",class:"text-sm"},"Stay Logged in",-1)),le=d(()=>e("button",{type:"submit",class:"bg-info text-default py-1 px-3 rounded"}," Login ",-1)),ne={class:"text-center mt-2"},re={key:3,class:"text-warning mt-2"},ce=B({__name:"LoginWindow",setup(u){const t=z(),I=A(),m=r(""),v=r(""),x=r(!1),_=r(!0),g=r(null),p=V(()=>t.isLoggedIn),U=V(()=>p.value?`Hello, ${t.username} ðŸŽ‰`:"Welcome, Kind Guest"),L=()=>{x.value=!x.value},M=async()=>{I.clearError();const s=await t.login(m.value,v.value);s.success?_.value&&(localStorage.setItem("user",JSON.stringify({username:m.value})),localStorage.setItem("stayLoggedIn","true")):g.value=s.message},E=async()=>{I.clearError();try{await t.logout(),localStorage.removeItem("user"),localStorage.removeItem("stayLoggedIn")}catch(s){g.value="An error occurred during logout.",console.error(s)}};return D(()=>{const s=JSON.parse(localStorage.getItem("user")||"null");s&&s.username!=="Kind Guest"&&t.setUser(s),t.initializeUser()}),(s,l)=>{const f=j,S=q;return o(),a("div",K,[e("div",{class:"flex flex-col items-start cursor-pointer",onClick:L},[c(t).avatarImage?(o(),a("img",{key:0,src:c(t).avatarImage,class:"w-8 h-8 rounded-full mb-2",alt:"Avatar"},null,8,O)):i("",!0),e("span",T,b(U.value),1),p.value?(o(),N(f,{key:1,to:"/dashboard",class:"text-accent underline text-sm"},{default:h(()=>[y(" Dashboard ")]),_:1})):i("",!0),p.value&&c(t).role==="admin"?(o(),N(f,{key:2,to:"/admin",class:"text-accent underline text-sm mt-1"},{default:h(()=>[y(" Admin ")]),_:1})):i("",!0)]),e("div",P,[w(S,{name:"tabler:user",class:"text-base-200 text-2xl cursor-pointer",onClick:L})]),x.value?(o(),a("div",R,[c(t).loading?(o(),a("div",X,[w(S,{name:"tabler:loader",class:"animate-spin text-lg mb-2"}),Y])):p.value?(o(),a("div",F,[e("div",Q,[e("span",Z,"Hello, "+b(c(t).username)+" ðŸŽ‰",1)]),e("button",{class:"bg-warning text-default py-1 px-3 rounded",onClick:E}," Logout ")])):(o(),a("form",{key:2,class:"space-y-4 z-50",autocomplete:_.value?"on":"off",onSubmit:W(M,["prevent"])},[e("div",null,[te,k(e("input",{id:"login","onUpdate:modelValue":l[0]||(l[0]=n=>m.value=n),type:"text",autocomplete:"username",class:"w-full p-2 border rounded",required:""},null,512),[[C,m.value]])]),e("div",null,[se,k(e("input",{id:"password","onUpdate:modelValue":l[1]||(l[1]=n=>v.value=n),type:"password",autocomplete:"current-password",class:"w-full p-2 border rounded",required:""},null,512),[[C,v.value]])]),e("div",oe,[e("div",null,[k(e("input",{id:"stayLoggedIn","onUpdate:modelValue":l[2]||(l[2]=n=>_.value=n),type:"checkbox",class:"mr-2"},null,512),[[$,_.value]]),ae]),le]),e("div",ne,[w(f,{to:"/register",class:"text-accent underline"},{default:h(()=>[y(" Register ")]),_:1})])],40,ee)),g.value?(o(),a("div",re,b(g.value),1)):i("",!0)])):i("",!0)])}}}),de=J(ce,[["__scopeId","data-v-265a7ac9"]]);export{de as default};
