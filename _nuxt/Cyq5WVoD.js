import Z from"./ayEoZZr8.js";import{d as j,X as q,Y as X,r as a,G as V,c as r,e as n,k as x,f as e,O as A,g as c,$ as I,a0 as $,t as P,b4 as W,h as U,n as D,Z as J,a2 as p,p as Q,j as ee,l as te}from"./CpGAEQl5.js";const S=_=>(Q("data-v-df807a50"),_=_(),ee(),_),se={class:"bg-base-200 flex flex-col items-center p-4 rounded-2xl"},ae=S(()=>e("h1",{class:"text-3xl font-bold text-primary mb-4"},"Kind Robots",-1)),oe={key:0,class:"text-lg text-info mb-4"},le=S(()=>e("a",{href:"/dashboard",class:"text-accent"},"go to the dashboard",-1)),re={key:0},ne=S(()=>e("h1",{class:"text-4xl font-bold text-primary mb-4"}," Pick a Cool Username ",-1)),ie={class:"relative mb-4"},ue={key:0,class:"absolute text-xs text-warning right-2 bottom-1"},de={key:1},ce={class:"text-2xl font-semibold text-primary mb-2"},ve=S(()=>e("p",{class:"text-lg mb-2"},"Optional details:",-1)),me={class:"relative group mb-4"},pe={class:"relative group mb-4"},ge=["type"],be={class:"absolute inset-y-0 right-0 flex items-center pr-3"},fe={key:0,class:"text-xs text-warning right-2 bottom-1 absolute"},he={key:0,class:"relative group mb-4"},xe=["type"],_e={class:"absolute inset-y-0 right-0 flex items-center pr-3"},ye={key:1,class:"my-2 px-4 py-2 text-lg text-info bg-info-light rounded"},we={key:2,class:"my-2 px-4 py-2 text-lg text-warning bg-warning-light rounded"},Re=["disabled"],ke={key:0},Ee={key:1},Ie=j({__name:"registration-form",setup(_){const v=q(),m=X();v.initializeUser();const u=a(""),C=a(""),o=a(""),y=a(""),f=a(!1),w=a(""),h=a(""),R=a(!1),N=a(""),k=a(!1),d=a(""),E=a(1),g=a(!1),b=a(!1),L=()=>{if(!o.value){d.value="",b.value=!1;return}const s=/^.{8,}$/,t=/\d/,l=/[a-zA-Z]/;s.test(o.value)?t.test(o.value)?l.test(o.value)?(d.value="",b.value=!0):(d.value="Include at least one letter",b.value=!1):(d.value="Include at least one number",b.value=!1):(d.value="At least 8 characters",b.value=!1)},K=()=>{o.value&&o.value!==y.value?d.value="Passwords do not match":d.value=""},M=a(""),G=async()=>{try{const s=await v.getUsernames();f.value=s.includes(u.value),f.value?h.value=`Username "${u.value}" already exists.`:h.value=""}catch(s){s instanceof Error?m.setError(p.UNKNOWN_ERROR,`Error checking username availability: ${s.message}`):m.setError(p.UNKNOWN_ERROR,"An unknown error occurred while checking username availability.")}},O=s=>{s===2&&(M.value=`Welcome, ${u.value}!`),E.value=s},T=V(()=>u.value&&!f.value&&(E.value===1||(!o.value||!d.value)&&o.value===y.value)),H=()=>{k.value=!k.value},z=()=>{g.value=!g.value},B=V(()=>v.isLoggedIn),F=()=>{localStorage.removeItem("api_key"),localStorage.removeItem("token")},Y=async()=>{if(T.value){R.value=!0,N.value="Registering user...";try{F();const s={username:u.value,email:C.value,password:o.value};if((await v.register(s)).success){N.value="Welcome to Kind Robots!",w.value="Welcome to Kind Robots!";try{const l={username:u.value};o.value&&(l.password=o.value),await v.login(l)}catch(l){l instanceof Error?m.setError(p.AUTH_ERROR,`Login failed: ${l.message}`):m.setError(p.AUTH_ERROR,"An unknown error occurred during login.")}}else w.value="",h.value="Registration failed. Please try again.",m.setError(p.REGISTRATION_ERROR,"Registration failed. Please try again.")}catch(s){s instanceof Error?m.setError(p.REGISTRATION_ERROR,`Registration failed: ${s.message}`):m.setError(p.REGISTRATION_ERROR,"An unknown error occurred during registration.")}R.value=!1}};return(s,t)=>{const l=Z;return r(),n("div",se,[ae,B.value?(r(),n("div",oe,[x(" You are already logged in. Would you like to "),le,x(" or "),e("a",{href:"#",class:"text-warning",onClick:t[0]||(t[0]=(...i)=>A(v).logout&&A(v).logout(...i))},"log out"),x("? ")])):c("",!0),e("form",{class:"space-y-4 w-full max-w-sm",onSubmit:J(Y,["prevent"])},[E.value===1?(r(),n("div",re,[ne,e("div",ie,[I(e("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>u.value=i),type:"text",placeholder:"Username",required:"",class:"w-full p-2 border rounded text-4xl bg-base-200 placeholder-base-300","aria-label":"Username",autocomplete:"username",onInput:G},null,544),[[$,u.value]]),f.value?(r(),n("p",ue," Username already exists ")):c("",!0)]),u.value&&!f.value?(r(),n("button",{key:0,type:"button",class:"w-full bg-primary text-lg text-base-100 p-2 rounded hover:bg-primary-dark transition duration-300",onClick:t[2]||(t[2]=i=>O(2))}," That's my name! ")):c("",!0)])):c("",!0),E.value===2?(r(),n("div",de,[e("h2",ce," Welcome, "+P(u.value)+"! ",1),e("button",{type:"button",class:"text-md mb-4",onClick:t[3]||(t[3]=i=>O(1))}," I want a different username "),ve,e("div",me,[I(e("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>C.value=i),type:"email",placeholder:"Email (optional)",class:"w-full p-2 border rounded text-lg bg-base-200 placeholder-base-300","aria-label":"Email",autocomplete:"email"},null,512),[[$,C.value]])]),e("div",pe,[I(e("input",{"onUpdate:modelValue":t[5]||(t[5]=i=>o.value=i),type:k.value?"text":"password",placeholder:"Password (keep it blank if you prefer)",class:"w-full p-2 border rounded text-lg bg-base-200 placeholder-base-300","aria-label":"Password",autocomplete:"new-password",onInput:L},null,40,ge),[[W,o.value]]),e("div",be,[U(l,{name:"tabler:eye",class:D(k.value?"text-base-300 cursor-pointer hover:text-warning":"text-base-300 cursor-pointer hover:text-success"),title:"Show/Hide Password",onClick:H},null,8,["class"])]),d.value?(r(),n("p",fe,P(d.value),1)):c("",!0)]),b.value?(r(),n("div",he,[I(e("input",{"onUpdate:modelValue":t[6]||(t[6]=i=>y.value=i),type:g.value?"text":"password",placeholder:"Confirm Password",class:"w-full p-2 border rounded text-lg bg-base-200 placeholder-base-300","aria-label":"Confirm Password",autocomplete:"new-password",onInput:K},null,40,xe),[[W,y.value]]),e("div",_e,[U(l,{name:g.value?"tabler:eye-off":"tabler:eye",class:D(g.value?"text-base-300 cursor-pointer hover:text-warning":"text-base-300 cursor-pointer hover:text-success"),title:g.value?"Hide Password":"Show Password",onClick:z},null,8,["name","class","title"])])])):c("",!0),w.value?(r(),n("div",ye,[U(l,{name:"tabler:info-circle",class:"mr-2"}),x(" "+P(w.value),1)])):c("",!0),h.value?(r(),n("div",we,[U(l,{name:"tabler:alert-triangle",class:"mr-2"}),x(" "+P(h.value),1)])):c("",!0),e("button",{type:"submit",disabled:!T.value||R.value,class:"w-full bg-primary text-lg text-base-100 p-2 rounded hover:bg-primary-dark transition duration-300"},[R.value?(r(),n("span",ke,"Registering...")):(r(),n("span",Ee,"Register"))],8,Re)])):c("",!0)],32)])}}}),Se=te(Ie,[["__scopeId","data-v-df807a50"]]);export{Se as default};
