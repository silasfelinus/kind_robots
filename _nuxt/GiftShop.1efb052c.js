import $ from"./ProductGallery.92515c59.js";import _ from"./ShoppingCart.84dfdec8.js";import{aL as w,a0 as d,d as b,W as B,r as v,b as f,c as g,e as l,g as p,t as E,f as j}from"./entry.10259a9c.js";import{u as x}from"./ProductCard.vue.4b9f363f.js";import"./productStore.8b6e3e54.js";import"./CartItem.8bb58519.js";const A=w({id:"customer",state:()=>({customers:[],currentCustomer:null}),actions:{setCurrentCustomer(s){this.currentCustomer=s},clearCurrentCustomer(){this.currentCustomer=null},async fetchCustomerByUserId(s){try{const t=await(await fetch(`/api/customers/userId/${s}.get.ts`)).json();return t.success?(this.setCurrentCustomer(t.customer),{success:!0,customerId:t.customer.id}):{success:!1,message:t.message}}catch(e){const{success:t,message:o,statusCode:r}=d({error:e});return console.error(`Fetch Customer By UserId Error: ${o}, Status Code: ${r}, Success: ${t}`),{success:!1,message:o}}},async fetchCustomerByEmail(s){try{const t=await(await fetch(`/api/customers/email/${s}.get.ts`)).json();if(t.success)this.setCurrentCustomer(t.customer);else throw new Error(t.message)}catch(e){const{success:t,message:o,statusCode:r}=d({error:e});console.error(`Fetch Customer By Email Error: ${o}, Status Code: ${r}, Success: ${t}`)}},async fetchAndSetCurrentCustomerById(s){try{const e=await this.fetchCustomerById(s);e&&this.setCurrentCustomer(e)}catch(e){const{success:t,message:o,statusCode:r}=d({error:e});console.error(`Fetch And Set Current Customer By ID Error: ${o}, Status Code: ${r}, Success: ${t}`)}},setCustomers(s){this.customers=s},getCustomerById(s){return this.customers.find(e=>e.id===s)},async fetchCustomers(){try{const e=await(await fetch("/api/customers/index.get.ts")).json();e.success?this.setCustomers(e.customers):console.error(`Failed to fetch customers: ${e.message}`)}catch(s){console.error(`An error occurred while fetching customers: ${s}`)}},async fetchCustomerById(s){try{return(await(await fetch(`/api/customers/${s}.get.ts`)).json()).customer}catch(e){console.error(`An error occurred while fetching customer by id: ${e}`)}},async createCustomer(s){try{const t=await(await fetch("/api/customers/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();return t.success?(this.customers.push(t.newCustomer),{success:!0,customerId:t.newCustomer.id}):{success:!1,message:t.message}}catch(e){const{success:t,message:o,statusCode:r}=d({error:e});return console.error(`Create Customer Error: ${o}, Status Code: ${r}, Success: ${t}`),{success:!1,message:o}}},async updateCustomer(s,e){try{if((await(await fetch(`/api/customers/${s}.patch.ts`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()).success){const r=this.customers.findIndex(m=>m.id===s);r!==-1&&(this.customers[r]={...this.customers[r],...e})}}catch(t){console.error(`An error occurred while updating the customer: ${t}`)}},async deleteCustomer(s){try{if((await(await fetch(`/api/customers/${s}.delete.ts`,{method:"DELETE"})).json()).success){const o=this.customers.findIndex(r=>r.id===s);o!==-1&&this.customers.splice(o,1)}}catch(e){console.error(`An error occurred while deleting the customer: ${e}`)}}}}),y=["Adventurous","Bouncy","Curious","Dazzling","Eccentric","Fluffy","Graceful","Hilarious","Ingenious","Jolly","Kindhearted","Lively","Majestic","Nimble","Optimistic","Playful","Quirky","Radiant","Spirited","Tender","Unique","Vibrant","Whimsical","Xenodochial","Youthful","Zany"],C=["Albatross","Butterfly","Chameleon","Dolphin","Elephant","Flamingo","Giraffe","Hedgehog","Iguana","Jellyfish","Kangaroo","Lemur","Meerkat","Narwhal","Octopus","Panda","Quokka","Raccoon","Seahorse","Tiger","Uakari","Viper","Walrus","Xerus","Yak","Zebra"],I=["the Amiable","the Brilliant","the Courageous","the Daring","the Enigmatic","the Fearless","the Generous","the Humble","the Imaginative","the Joyful","the Kind","the Luminous","the Marvelous","the Noble","the Outstanding","the Persuasive","the Quixotic","the Resilient","the Serendipitous","the Tenacious","the Unstoppable","the Victorious","the Wise","the Xanthous","the Youthful","the Zealous"];function k(){const s=y[Math.floor(Math.random()*y.length)],e=C[Math.floor(Math.random()*C.length)],t=I[Math.floor(Math.random()*I.length)];return`${s} ${e} ${t}`}const N={class:"giftshop-container bg-base-200 rounded-2xl p-4 flex flex-col"},M=l("div",{class:"giftshop-header text-lg font-bold mb-4"},"Welcome to the Gift Shop!",-1),T={class:"product-gallery mb-4"},F={key:0,class:"shopping-cart"},P=b({__name:"GiftShop",setup(s){const e=B(),t=x(),o=A(),r=v(!1),m=()=>{r.value=!r.value};return(async()=>{var h;try{if(e.userId===0){const c=await e.register({username:k()});if(c!=null&&c.success&&((h=c==null?void 0:c.user)!=null&&h.id)){const a=c.user.id,n=await o.createCustomer({userId:a});if(n!=null&&n.success&&(n!=null&&n.customerId)){const u=n.customerId,i=await t.createCart(u);if(i!=null&&i.success&&(i!=null&&i.cartId)){const S=i.cartId;localStorage.setItem("userId",a.toString()),localStorage.setItem("cartId",S.toString())}}}}else{const c=await o.fetchCustomerByUserId(e.userId);if(!(c!=null&&c.success)||!(c!=null&&c.customerId)){const a=await o.createCustomer({userId:e.userId});if(a!=null&&a.success&&(a!=null&&a.customerId)){const n=a.customerId,u=await t.createCart(n);if(u!=null&&u.success&&(u!=null&&u.cartId)){const i=u.cartId;localStorage.setItem("cartId",i.toString())}}}}}catch(c){console.error(`Initialization Error: ${c.message}`)}})(),(h,c)=>{const a=$,n=_;return f(),g("div",N,[M,l("div",T,[p(a)]),l("button",{class:"toggle-cart bg-primary text-lg px-2 py-1 rounded",onClick:m},E(r.value?"Hide Cart":"Show Cart"),1),r.value?(f(),g("div",F,[p(n)])):j("",!0)])}}});export{P as default};
